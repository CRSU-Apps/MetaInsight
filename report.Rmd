---
title: "MetaInsight report"
output: html_document
params:
  axis: NA
  bugsnetdt: NA
  data: NA
  excluded: NA
  exclusionbox: NA
  forest: NA
  freq_all: NA
  freq_sub: NA
  label: NA
  metaoutcome: NA
  model: NA
  netgraph_label: NA
  outcome_measure: NA
  ranking: NA
  reference_alter: NA
---

```{r include = FALSE}
library(knitr)

```

### User inputs and selections

**Outcome type**  
Continuous (mean difference) or binary (odds ratio)

```{r}
params$metaoutcome
```

**Study data and treatment labels**

```{r}
params$data

treatment_label(params$label)
```

**Outcome measure**  
Mean difference (MD) or standardised mean difference (SMD) for continuous data  
Odds ratio (OR), risk ratio (RR) or risk difference (RD) for binary data  

```{r}
params$outcome_measure
```

For treatment rankings, smaller outcome values (e.g. smaller mean values for continuous data, or ORs less than 1 for binary data) are desirable (good) or undesirable (bad)

```{r}
params$ranking
```

**Model**  
Random effect (RE) or fixed effect (FE)

```{r}
params$model
```

**Excluded studies**

```{r}
paste(params$excluded, collapse = (", "))
```

### MetaInsight app outputs

**Data used for NMA**

```{r}
knitr::kable(params$data)
```

**Summary of study characteristics**  
Characteristics table of all studies

```{r}
summary_table_plot(params$bugsnetdt, params$metaoutcome)
```

**Summary of study characteristics**  
Characteristics table with studies excluded

```{r}
summary_table_plot(filter(params$bugsnetdt, !Study %in% params$exclusionbox), params$metaoutcome)
```

**Study results**
Individual study results (for all studies) grouped by treatment comparison

```{r}
make_netStudy(params$freq_sub, params$outcome_measure, params$forest$ForestHeader, params$forest$ForestTitle)
```

**Network plot**  
Network plot of all studies

Number of trials shown on the line

```{r}
make_netgraph(params$freq_all, params$netgraph_label$label_all)
```

Number of trials indicated by node size and line thickness

```{r}
make_netplot(params$bugsnetdt, params$netgraph_label$label_all)
```

Network connectivity

```{r}
make_netconnect(params$freq_all)
```


**Network plot**  
Network plot with studies excluded  

Number of trials shown on the line

```{r}
make_netgraph(params$freq_sub, params$netgraph_label$label_excluded)
```

Number of trials indicated by node size and line thickness

```{r}
make_netplot(filter(params$bugsnetdt, !Study %in% params$exclusionbox), params$netgraph_label$label_all)
```

Network connectivity

```{r}
make_netconnect(params$freq_sub)
```

**Forest Plot**  

Results for all studies

```{r}
make_netComp(params$freq_all, params$model, params$reference_alter$ref_all, params$axis$freqmin, params$axis$freqmax)

texttau(params$freq_all, params$outcome_measure, params$model)

make_refText(params$reference_alter$ref_all)
```

Results with studies excluded

```{r}
make_netComp(params$freq_sub, params$model, params$reference_alter$ref_sub, params$axis$freqmin_sub, params$axis$freqmax_sub)

texttau(params$freq_sub, params$outcome_measure, params$model)

make_refText(params$reference_alter$ref_sub)
```








